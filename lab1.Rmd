---
title: "Lab 1"
author: "Carmen Canedo"
date: "May 23, 2020"
output:
  pdf_document: default
  html_notebook: default
editor_options:
  chunk_output_type: inline
---

# About
For this lab, I used the GPS tracking app on my iPhone, myTracker, to trace myself walking a straight path outside of my house in Nashville, TN. I tried to maintain a steady pace as I walked up and down the street. 

Below you will find an analysis of my path that was created using R statistical software. My code is available below, but my step by step process can be found on [my GitHub page](https://github.com/carmen-canedo/stat-202-lab1).

# Necessary Packages
```{r, message=FALSE, warning=FALSE}
library(mdsr)
library(XML)
library(OpenStreetMap)
library(lubridate)
library(ggmap)
library(raster)
library(sp)
```

# Getting the data ready
## Loading in data
```{r}
walking <- read.csv("lab-1.csv", header = TRUE)
```

## Cleaning data
###Getting rid of unnecessary columns
```{r}
walking <- walking %>% 
  dplyr::select(-type, -desc, -name)
```

### Making column names simpler
```{r}
walking <- walking %>% 
  rename(altitude = altitude..ft.) %>% 
  rename(speed = speed..mph.) %>% 
  rename(distance_mi = distance..mi.) %>% 
  rename(distance_int_ft = distance_interval..ft.)
```

# Summary stats calculations
```{r}
sum_latitude <- favstats( ~ latitude, data = walking)

sum_longitude <- favstats( ~ longitude, data = walking)

sum_altitude <- favstats( ~ altitude, data = walking)

sum_speed <- favstats( ~ speed, data = walking)

sum_distance_mi <- favstats( ~ distance_mi, data = walking)

sum_dist_int_ft <- favstats( ~ distance_int_ft, data = walking)
```

## Results
```{r}
# Results
sum_latitude
sum_longitude
sum_altitude
sum_speed
sum_distance_mi
sum_dist_int_ft
```

### Analysis
* Question 1:
  + The standard deviation is larger for latitude.

* Question 2:
  + This tells us that the latitude moves farther from the mean latitude.

# Creating Latitude v. Longitude Scatter Plot
```{r}
lat_v_long <- walking %>%
  ggplot(aes(x = longitude, y = latitude)) +
  geom_point(alpha = 0.8, aes(color = speed), size = 3) +
  scale_color_gradient(low = "blue", high = "red") +
  theme_minimal() +
  labs(title = "Longitude versus Latitude",
       subtitle = "Carmen Canedo",
       caption = "STAT 202, Summer 2020",
       x = "Longitude",
       y = "Latitude",
       color = "Speed (mph)")

lat_v_long
```

## Adding Line of Best Fit
```{r}
lat_v_long <- lat_v_long +
  geom_smooth(method = "lm")

lat_v_long
```

## Simple Linear Regression Results
```{r}
# Calculating model
model <- lm(latitude ~ longitude, data = walking)

# Finding correlation coefficient
coef(model)
```

*Formula for line of best fit:* \n
$latitude = 651.653 + 7.0954(longitude)$

### Analysis
  + Is the line of best fit a good tool to estimate the path traveled? Why or why not?
  + How does the correlation help you answer part b?

# Mapping the route
I referenced exercises from [here](https://rpubs.com/ials2un/gpx1)

## Getting the data
In order to ensure that all the values work when mapped, this equation places the vectors correctly.
```{r}
# Function to shift vectors
shift_vec <- function(vector, shift) {
  if (length(vec) <= abs(shift)) {
    rep(NA, length(vec))
  } else {
    if (shift >= 0) {
      c(rep(NA, shift), vec[1:(length(vec) - shift)])
    } else {
      c(vec[(abs(shift) + 1):length(vec)])
    }
  }
}
```

## Reading in GPX file
```{r}
# Limits to 10 digits
options(digits = 10)

# Parsing the GPX file
parsed_file <- htmlTreeParse(file = "lab-1-raw-data.gpx",
                             error = function(...) {},
                             useInternalNodes = TRUE)

# Get all times and coordinates via the respective xpath
times <- xpathSApply(parsed_file, path = "//trkpt/time", xmlValue)
coords <- xpathSApply(parsed_file, path = "//trkpt", xmlAttrs)

# Extract latitude and longitude from the coordinates
lats <- as.numeric(coords["lat",])
lons <- as.numeric(coords["lon",])
```

## Putting values into dataframe
This allows us to have all of the GPX file in one place, ready to be placed onto a map.
```{r}
geodf <- data.frame(lat = lats, lon = lons, time = times)
```

## Querying map background
I used my Google API to access the static map used below.
```{r, message=FALSE}
street <- get_map(location = "409 N 15th St., Lockeland Springs, Nashville, Tennessee",
                  zoom = 19,
                  maptype = "roadmap")
```


## Finished product
```{r}
# Plotting points
path <- ggmap(street) +
  geom_point(data = geodf,
             aes(x = lon, y = lat),
             size = 1,
             alpha = 0.7,
             color = "red")

# Adding details
path <- path +
  labs(x = "Longitude",
       y = "Latitude",
       title = "Walking Path Plotted using myTracks",
       subtitle = "Carmen Canedo",
       caption = "STAT 202, Summer 2020")

path
```

# Conclusion
* What was learned
* Et ecetera